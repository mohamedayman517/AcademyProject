<div class="api-health">
  <h2>API Health Check</h2>

  <section class="token">
    <label for="token">Bearer Token</label>
    <input id="token" type="text" [(ngModel)]="tokenInput" placeholder="Paste JWT (with or without 'Bearer ')" />
    <button (click)="setToken()">Save Token</button>
    <button (click)="clearToken()">Clear Token</button>
  </section>

  <section class="swagger">
    <button (click)="fetchSwaggerPaths()" [disabled]="loadingSwagger">Fetch Swagger Paths</button>
    <span *ngIf="loadingSwagger">Loading swagger...</span>
    <div *ngIf="swaggerPaths.length">
      <p>Swagger paths: {{ swaggerPaths.length }}</p>
      <details>
        <summary>Show paths</summary>
        <ul>
          <li *ngFor="let p of swaggerPaths">{{ p }}</li>
        </ul>
      </details>
    </div>
  </section>

  <section class="checks">
    <button (click)="runChecks()" [disabled]="running">Run Sample GET Checks</button>
    <span *ngIf="running">Running...</span>

    <table *ngIf="checks.length">
      <thead>
        <tr>
          <th>Path</th>
          <th>Status</th>
          <th>Message</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let c of checks" [class.ok]="c.ok" [class.fail]="!c.ok">
          <td>{{ c.path }}</td>
          <td>{{ c.status || '-' }}</td>
          <td>{{ c.ok ? 'OK' : (c.error || 'Error') }}</td>
        </tr>
      </tbody>
    </table>
  </section>
</div>
